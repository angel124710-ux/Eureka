-- ============================================
-- UNIVERSAL LOCK CONTROLLER - PC & MOBILE
-- Funciona com qualquer aimbot que use _G
-- ============================================

_G.CharLockEnabled = false
_G.CamLockEnabled = false
_G.Loaded = false

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local player = Players.LocalPlayer
local pGui = player:WaitForChild("PlayerGui")

-- Detectar plataforma
local function isMobile()
    return UserInputService.TouchEnabled and not UserInputService.MouseEnabled
end

-- Limpar UI antiga
local function cleanup()
    local old = pGui:FindFirstChild("LockController")
    if old then old:Destroy() end
end

-- Criar GUI (funciona igual em PC e Mobile)
local function createGUI()
    cleanup()
    
    -- ScreenGui
    local sg = Instance.new("ScreenGui")
    sg.Name = "LockController"
    sg.Parent = pGui
    sg.ResetOnSpawn = false
    sg.IgnoreGuiInset = true
    
    -- Frame principal
    local frame = Instance.new("Frame")
    frame.Parent = sg
    frame.Size = UDim2.new(0, 180, 0, 110)
    frame.Position = UDim2.new(0, 15, 0, 120)
    frame.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
    frame.BackgroundTransparency = 0.1
    frame.BorderSizePixel = 0
    frame.Active = true
    frame.Draggable = true  -- ArrastÃ¡vel em mobile e PC
    
    -- Borda
    local stroke = Instance.new("UIStroke")
    stroke.Parent = frame
    stroke.Color = Color3.fromRGB(0, 255, 255)
    stroke.Thickness = 1.5
    stroke.Transparency = 0.3
    
    -- Cantos
    local corner = Instance.new("UICorner")
    corner.Parent = frame
    corner.CornerRadius = UDim.new(0, 8)
    
    -- TÃ­tulo
    local title = Instance.new("TextLabel")
    title.Parent = frame
    title.Size = UDim2.new(1, -10, 0, 25)
    title.Position = UDim2.new(0, 5, 0, 5)
    title.BackgroundTransparency = 1
    title.Text = "ðŸ”° LOCK CONTROLLER"
    title.TextColor3 = Color3.fromRGB(0, 255, 255)
    title.Font = Enum.Font.GothamBold
    title.TextSize = 14
    title.TextXAlignment = Enum.TextXAlignment.Left
    
    -- Character Lock Button
    local charBtn = Instance.new("TextButton")
    charBtn.Parent = frame
    charBtn.Size = UDim2.new(1, -20, 0, 32)
    charBtn.Position = UDim2.new(0, 10, 0, 35)
    charBtn.BackgroundColor3 = Color3.fromRGB(180, 0, 0)
    charBtn.Text = "ðŸ‘¤ CHARACTER LOCK: OFF"
    charBtn.TextColor3 = Color3.new(1, 1, 1)
    charBtn.Font = Enum.Font.GothamBold
    charBtn.TextSize = 12
    charBtn.AutoButtonColor = false
    
    local btnCorner = Instance.new("UICorner")
    btnCorner.Parent = charBtn
    btnCorner.CornerRadius = UDim.new(0, 5)
    
    -- Camera Lock Button
    local camBtn = Instance.new("TextButton")
    camBtn.Parent = frame
    camBtn.Size = UDim2.new(1, -20, 0, 32)
    camBtn.Position = UDim2.new(0, 10, 0, 72)
    camBtn.BackgroundColor3 = Color3.fromRGB(180, 0, 0)
    camBtn.Text = "ðŸ“· CAMERA LOCK: OFF"
    camBtn.TextColor3 = Color3.new(1, 1, 1)
    camBtn.Font = Enum.Font.GothamBold
    camBtn.TextSize = 12
    camBtn.AutoButtonColor = false
    
    local camCorner = Instance.new("UICorner")
    camCorner.Parent = camBtn
    camCorner.CornerRadius = UDim.new(0, 5)
    
    -- FunÃ§Ã£o para atualizar cores dos botÃµes
    local function updateButtons()
        charBtn.BackgroundColor3 = _G.CharLockEnabled and 
            Color3.fromRGB(0, 150, 0) or Color3.fromRGB(180, 0, 0)
        charBtn.Text = _G.CharLockEnabled and 
            "ðŸ‘¤ CHARACTER LOCK: ON" or "ðŸ‘¤ CHARACTER LOCK: OFF"
            
        camBtn.BackgroundColor3 = _G.CamLockEnabled and 
            Color3.fromRGB(0, 150, 0) or Color3.fromRGB(180, 0, 0)
        camBtn.Text = _G.CamLockEnabled and 
            "ðŸ“· CAMERA LOCK: ON" or "ðŸ“· CAMERA LOCK: OFF"
    end
    
    -- Eventos dos botÃµes
    charBtn.MouseButton1Click:Connect(function()
        _G.CharLockEnabled = not _G.CharLockEnabled
        
        -- Tenta chamar a funÃ§Ã£o do script original (se existir)
        pcall(function()
            if _G.CharacterLock then
                _G.CharacterLock(_G.CharLockEnabled)
            elseif type(_G.ToggleCharacterLock) == "function" then
                _G.ToggleCharacterLock(_G.CharLockEnabled)
            end
        end)
        
        updateButtons()
        
        -- Feedback visual
        charBtn.TextSize = 13
        task.wait(0.1)
        charBtn.TextSize = 12
    end)
    
    camBtn.MouseButton1Click:Connect(function()
        _G.CamLockEnabled = not _G.CamLockEnabled
        
        -- Tenta chamar a funÃ§Ã£o do script original (se existir)
        pcall(function()
            if _G.CameraLock then
                _G.CameraLock(_G.CamLockEnabled)
            elseif type(_G.ToggleCameraLock) == "function" then
                _G.ToggleCameraLock(_G.CamLockEnabled)
            end
        end)
        
        updateButtons()
        
        -- Feedback visual
        camBtn.TextSize = 13
        task.wait(0.1)
        camBtn.TextSize = 12
    end)
    
    -- Atualizar estado inicial
    updateButtons()
    
    -- Monitorar mudanÃ§as nas variÃ¡veis globais
    spawn(function()
        while true do
            task.wait(0.5)
            -- Se alguÃ©m mudar as variÃ¡veis diretamente, atualiza a UI
            local currentCharState = _G.CharLockEnabled
            local currentCamState = _G.CamLockEnabled
            
            if (currentCharState and charBtn.Text == "ðŸ‘¤ CHARACTER LOCK: OFF") or
               (not currentCharState and charBtn.Text == "ðŸ‘¤ CHARACTER LOCK: ON") then
                updateButtons()
            end
            
            if (currentCamState and camBtn.Text == "ðŸ“· CAMERA LOCK: OFF") or
               (not currentCamState and camBtn.Text == "ðŸ“· CAMERA LOCK: ON") then
                updateButtons()
            end
        end
    end)
    
    -- Atalhos de teclado (funcionam apenas no PC)
    if not isMobile() then
        UserInputService.InputBegan:Connect(function(input, gpe)
            if gpe then return end
            
            if input.KeyCode == Enum.KeyCode.P then
                charBtn.MouseButton1Click:Fire()
            elseif input.KeyCode == Enum.KeyCode.L then
                camBtn.MouseButton1Click:Fire()
            end
        end)
        
        -- Mostrar atalhos no tÃ­tulo (sÃ³ no PC)
        title.Text = "ðŸ”° LOCK CTRL [P] [L]"
    end
    
    return sg
end

-- Inicializar
pcall(function()
    -- Criar GUI
    createGUI()
    
    -- Recriar quando o personagem renascer
    player.CharacterAdded:Connect(function()
        task.wait(1.5)
        createGUI()
    end)
end)

print("âœ… Lock Controller carregado! Pressione P/L no PC ou use os botÃµes no Mobile")
